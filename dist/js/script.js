!function(){for(var e,t=function(){},r=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],s=r.length,a=window.console=window.console||{};s--;)e=r[s],a[e]||(a[e]=t)}(),document.addEventListener("DOMContentLoaded",function(){var e=function(){var e=function(e,t,r,s,a,n,i){this.id=e,this.name=t,this.password=r,this.firstName=s,this.lastName=a,this.dateBirth=n,this.group=i},t=function(e,t){this.id=e,this.name=t},r={users:[],groups:[]},s=-1,a=-1;return{getDataFromDB:function(s){$.ajax({type:"GET",url:"php/getData.php",cache:!1,data:{table:"users"},contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){for(i=0;i<a.length;i++){var n=new e(a[i][0],a[i][1],a[i][2],a[i][3],a[i][4],a[i][5],a[i][6]);r.users.push(n)}$.ajax({type:"GET",url:"php/getData.php",cache:!1,data:{table:"groups"},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){for(i=0;i<e.length;i++){var a=new t(e[i][0],e[i][1]);r.groups.push(a)}$.isFunction(s)&&s()},error:function(e){alert("Error"),console.log(e)}})},error:function(e){alert("Error"),console.log(e)}})},getData:function(){return r},addToDB:function(e,t,r){var s=e+"s";$.ajax({type:"POST",url:"php/add.php",cache:!1,data:{table:s,name:t.name,password:t.password,firstName:t.firstName,lastName:t.lastName,dateBirth:t.dateBirth,group:t.group},dataType:"text",success:function(){$.isFunction(r)&&r()},error:function(e){alert("Error"),console.log(e)}})},setSelectedUserId:function(e){s=e},getSelectedUserId:function(){return s},setSelectedGroupId:function(e){a=e},getSelectedGroupId:function(){return a},removeFromDB:function(e,t,s){var a=e+"s";$.ajax({type:"POST",url:"php/remove.php",cache:!1,data:{table:a,id:t},dataType:"text",success:function(){$.isFunction(s)&&s(r)},error:function(e){alert("Error."),console.log(e)}})},editInDB:function(e,t,r,s){var a=e+"s";$.ajax({type:"POST",url:"php/edit.php",cache:!1,data:{table:a,id:t,name:r.name,password:r.password,firstName:r.firstName,lastName:r.lastName,dateBirth:r.dateBirth,group:r.group},dataType:"text",success:function(){$.isFunction(s)&&s()},error:function(e){alert("Error"),console.log(e)}})},changeNameToIdGroup:function(e){for(i=0;i<r.groups.length;i++)if(e.group==r.groups[i].name){e.group=r.groups[i].id;break}return e},removeTempData:function(){r.users.splice(0,r.users.length),r.groups.splice(0,r.groups.length)}}}(),t=function(){var e={nameInput:".nameInput",nameGroupInput:".nameGroupInput",passwordInput:".passwordInput",firstNameInput:".firstNameInput",lastNameInput:".lastNameInput",dateBirthInput:".dateBirthInput",selectUserInput:".selectUserInput",selectGroupInput:".selectGroupInput",addUserBtn:".addUserBtn",editUserBtn:".editUserBtn",remUserBtn:".remUserBtn",userListTable:".userListTable",groupListTable:".groupListTable",idList:".idList",idGroupList:".idGroupList",nameList:".nameList",nameGroupList:".nameGroupList",passwordList:".passwordList",firstNameList:".firstNameList",lastNameList:".lastNameList",dateBirthList:".dateBirthList",groupList:".groupList",dangerClass:".danger",addGroupBtn:".addGroupBtn",editGroupBtn:".editGroupBtn",remGroupBtn:".remGroupBtn"};return{getDOMstrings:function(){return e},printUserList:function(t){for(i=0;i<t.users.length;i++){var r='<tr><th scope="row" class="idList">%id%</th><td class="nameList">%name%</td><td class="passwordList">%password%</td><td class="firstNameList">%firstName%</td><td class="lastNameList">%lastName%</td><td class="dateBirthList">%dateBirth%</td><td class="groupList">undefined</td></tr>',s=r.replace("%name%",t.users[i].name),s=s.replace("%id%",t.users[i].id),s=s.replace("%password%",t.users[i].password),s=s.replace("%firstName%",t.users[i].firstName),s=s.replace("%lastName%",t.users[i].lastName),s=s.replace("%dateBirth%",t.users[i].dateBirth);for(ii=0;ii<t.groups.length;ii++)if(t.users[i].group==t.groups[ii].id){var s=s.replace("undefined",t.groups[ii].name);break}$(e.userListTable).append(s)}},printGroupList:function(t){for(i=0;i<t.groups.length;i++){var r='<tr><th scope="row" class="idGroupList">%id%</th><td class="nameGroupList">%name%</td></tr>',s=r.replace("%name%",t.groups[i].name),s=s.replace("%id%",t.groups[i].id);$(e.groupListTable).append(s)}},printSelectInputInUserList:function(t){for(i=0;i<t.groups.length;i++){var r='<option value="'+t.groups[i].name+'">%option%</option>',s=r.replace("%option%",t.groups[i].name);$(e.selectUserInput).append(s)}},removeSelectInputInUserList:function(){$(e.selectUserInput).empty()},getInputsValues:function(t){if("user"===t)var r={name:$(e.nameInput).val(),password:$(e.passwordInput).val(),firstName:$(e.firstNameInput).val(),lastName:$(e.lastNameInput).val(),dateBirth:$(e.dateBirthInput).val(),group:$(e.selectUserInput).val()};if("group"===t)var r={name:$(e.nameGroupInput).val()};return r},clearInputs:function(){$(e.nameInput).val(""),$(e.passwordInput).val(""),$(e.firstNameInput).val(""),$(e.lastNameInput).val(""),$(e.dateBirthInput).val(""),$(e.nameGroupInput).val("")},takeDataFromRow:function(t,r){var s=$(r).parent();if("user"===t)var a={id:$(s).find(e.idList).text(),name:$(s).find(e.nameList).text(),password:$(s).find(e.passwordList).text(),firstName:$(s).find(e.firstNameList).text(),lastName:$(s).find(e.lastNameList).text(),dateBirth:$(s).find(e.dateBirthList).text(),group:$(s).find(e.groupList).text()};if("group"===t)var a={id:$(s).find(e.idGroupList).text(),name:$(s).find(e.nameGroupList).text()};return a},putSelectedDataInInputs:function(t){$(e.nameInput).val(t.name),$(e.passwordInput).val(t.password),$(e.firstNameInput).val(t.firstName),$(e.lastNameInput).val(t.lastName),$(e.dateBirthInput).val(t.dateBirth),$(e.selectUserInput).val(t.group)},putSelectedDataInGroupInputs:function(t){$(e.nameGroupInput).val(t.name)},removeUserList:function(){$(e.userListTable).empty()},removeGroupList:function(){$(e.groupListTable).empty()}}}();(function(t,r){var s=r.getDOMstrings(),a=function(){$(s.userListTable).click(function(e){i("user",e.target)}),$(s.groupListTable).click(function(e){i("group",e.target)}),$(s.remUserBtn).click(function(){o("user")}),$(s.remGroupBtn).click(function(){o("group")}),$(s.addUserBtn).click(function(){u("user")}),$(s.addGroupBtn).click(function(){u("group")}),$(s.editUserBtn).click(function(){p("user")}),$(s.editGroupBtn).click(function(){p("group")})},n=function(){r.removeUserList(),r.removeGroupList(),r.removeSelectInputInUserList(),r.clearInputs(),e.removeTempData(),e.getDataFromDB(function(t){var t=e.getData();r.printUserList(t),r.printGroupList(t),r.printSelectInputInUserList(t)})},i=function(t,a){var n=s.dangerClass.slice(1),i=r.takeDataFromRow(t,a);0===$(s.dangerClass).length?($(a).parent().addClass(n),"user"===t&&(r.putSelectedDataInInputs(i),e.setSelectedUserId(i.id)),"group"===t&&(r.putSelectedDataInGroupInputs(i),e.setSelectedGroupId(i.id))):!1===$(a).parent().hasClass(n)?($(s.dangerClass).removeClass(n),r.clearInputs(),e.setSelectedUserId(-1),e.setSelectedGroupId(-1),$(a).parent().addClass(n),"user"===t&&(r.putSelectedDataInInputs(i),e.setSelectedUserId(i.id)),"group"===t&&(r.putSelectedDataInGroupInputs(i),e.setSelectedGroupId(i.id))):($(s.dangerClass).removeClass(n),r.clearInputs(),e.setSelectedUserId(-1),e.setSelectedGroupId(-1))},u=function(t){var s=r.getInputsValues(t);if("user"===t)var s=e.changeNameToIdGroup(s);e.addToDB(t,s,function(){n(),e.setSelectedUserId(-1),e.setSelectedGroupId(-1),alert(t+" added.")})},o=function(t){var r=-1;"user"===t?r=e.getSelectedUserId():"group"===t&&(r=e.getSelectedGroupId()),r<0?alert("Please select "+t+"."):e.removeFromDB(t,r,function(){n(),e.setSelectedUserId(-1),e.setSelectedGroupId(-1),alert(t+" removed.")})},p=function(t){var s=-1;if("user"===t&&(s=e.getSelectedUserId()),"group"===t&&(s=e.getSelectedGroupId()),s<0)alert("Please select "+t+".");else{var a=r.getInputsValues(t);a.id=s,"user"===t&&(a=e.changeNameToIdGroup(a)),e.editInDB(t,s,a,function(){n(),e.setSelectedUserId(-1),e.setSelectedGroupId(-1),alert(t+" edited.")})}};return{init:function(){console.log("App has started"),e.getDataFromDB(function(t){var t=e.getData();r.printUserList(t),r.printGroupList(t),r.printSelectInputInUserList(t),a()})}}})(0,t).init()});